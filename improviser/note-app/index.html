<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Solfege Tower (with Note/S Toggle and Letter Names for All Keys)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app-wrapper">
    <div class="controls-bar" id="controls-bar"></div>
    <div class="main-content">
      <div class="proportional-grid-wrapper">
        <div class="grid" id="grid"></div>
      </div>
    </div>
  </div>

  <div id="keyboard-modal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <div id="simulated-keyboard">
        <div class="keyboard-row">
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-spacer"></div>
          <div class="key key-flat" data-key="-">-</div>
          <div class="key key-sharp" data-key="=">=</div>
        </div>
        <div class="keyboard-row">
          <div class="key key-do" data-key="1">1</div>
          <div class="key key-re" data-key="2">2</div>
          <div class="key key-mi" data-key="3">3</div>
          <div class="key key-fa" data-key="4">4</div>
          <div class="key" data-key="5">5</div>
          <div class="key key-ti" data-key="6">6</div>
          <div class="key key-do" data-key="7">7</div>
          <div class="key key-re" data-key="8">8</div>
          <div class="key key-mi" data-key="9">9</div>
          <div class="key key-fa" data-key="0">0</div>
        </div>
        <div class="keyboard-row">
          <div class="key key-so" data-key="q">q</div>
          <div class="key key-la" data-key="w">w</div>
          <div class="key key-ti" data-key="e">e</div>
          <div class="key key-do" data-key="r">r</div>
          <div class="key" data-key="t">t</div>
          <div class="key key-fa" data-key="y">y</div>
          <div class="key key-so" data-key="u">u</div>
          <div class="key key-la" data-key="i">i</div>
          <div class="key key-ti" data-key="o">o</div>
          <div class="key key-do" data-key="p">p</div>
        </div>
        <div class="keyboard-row">
          <div class="key key-do" data-key="a">a</div>
          <div class="key key-re" data-key="s">s</div>
          <div class="key key-mi" data-key="d">d</div>
          <div class="key key-fa" data-key="f">f</div>
          <div class="key" data-key="g">g</div>
          <div class="key key-ti" data-key="h">h</div>
          <div class="key key-do" data-key="j">j</div>
          <div class="key key-re" data-key="k">k</div>
          <div class="key key-mi" data-key="l">l</div>
          <div class="key key-fa" data-key=";">;</div>
        </div>
        <div class="keyboard-row">
          <div class="key key-so" data-key="z">z</div>
          <div class="key key-la" data-key="x">x</div>
          <div class="key key-ti" data-key="c">c</div>
          <div class="key key-do" data-key="v">v</div>
          <div class="key" data-key="b">b</div>
          <div class="key key-fa" data-key="n">n</div>
          <div class="key key-so" data-key="m">m</div>
          <div class="key key-la" data-key=",">,</div>
          <div class="key key-ti" data-key=".">.</div>
          <div class="key key-do" data-key="/">/</div>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
   <!-- New script to listen for key presses from the parent page -->
 <script>
  window.addEventListener('message', function(event) {
    if (event.origin !== window.location.origin) {
      return;
    }
    
    if (event.data && (event.data.type === 'keydown' || event.data.type === 'keyup')) {
      // Create a fake keyboard event of the correct type (keydown OR keyup)
      // and dispatch it. Your app's original script.js will now hear
      // both the press and the release, just like normal.
      document.body.dispatchEvent(new KeyboardEvent(event.data.type, {
        'key': event.data.key,
        'bubbles': true
      }));
    }
  });
</script>
</body>
</html>
